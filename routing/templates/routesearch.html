{% extends 'base.html' %}


{% block header %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/routesearch_styles.css' %}">
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<main class="content">
    <h2>経路検索</h2>
    <p>検索条件を入力してください</p>

    <!-- 入力欄 -->
    <form action="/routesearch/" method="post">
        {% csrf_token %}
        <div class="form-group">
            <label for="start_spot">出発地点:</label>
            <select id="start_spot" name="start_spot">
                <option value="調布駅">調布駅</option>
            </select>
        </div>
        
        {% for i in spot_num_range %}
            <div class="form-group">
                <label for="spot{{ i }}">経由地点{{ i }}:</label>
                <select id="spot{{ i }}" name="spot{{ i }}">
                    <option value="セブンイレブン">セブンイレブン</option>
                    <option value="ファミリーマート">ファミリーマート</option>
                    <option value="ローソン">ローソン</option>
                    <option value="レストラン">レストラン</option>
                    <option value="駅">駅</option>
                </select>

                <label for="number{{ i }}">箇所数{{ i }}:</label>
                <input type="number" id="number{{ i }}" name="number{{ i }}" min="1" value="1">
            </div>
        {% endfor %}
        
        <div class="form-group">
            <label for="start_spot">到着地点:</label>
            <select id="start_spot" name="start_spot2">
                <option value="電気通信大学">電気通信大学</option>
            </select>
        </div>    

        <div id="submit-btn">
            <input type="submit" value="探索">
        </div>
    </form>

    {% for route in routes %}
        <div id="route-{{ forloop.counter }}" class="route-container">
            <h4>{{ route.name }}</h4>
            <p>距離: {{ route.distance }} m</p>  <!-- 距離の表示 -->
            <p>時間: {{ route.time }} 分</p>     <!-- 時間の表示 -->
            <p>経由地点:
            {% for via_spot in route.via_spots %}
                <p>{{ via_spot }}</p>     <!-- 時間の表示 -->
            {% endfor %}
            </p>
            {% load static %}
            <iframe src="{% static 'data/user_map1.html' %}" width="80%" height="600px" frameborder="0" style="float: right;"></iframe>
        </div>
    {% endfor %}
    
{% else %}
<div class="h1">
    アカウントを登録してください。アカウントをお持ちの方は、ログインしてください。
</div>
<!-- ログインされていなければログインページ表示 -->
<a href="{% url 'accounts:signup' %}" class="btn btn-primary">アカウント登録</a>
<a href="{% url 'accounts:login' %}" class="btn btn-primary">ログイン</a>
{% endif %}


<!-- JavaScriptの追加 -->
<script src="{% static 'scripts/routesearch_scripts.js' %}"></script>

{% endblock %}